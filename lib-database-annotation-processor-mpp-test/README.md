# Door database multiplatform test

This test project enables us to test the Javascript code generated by 
the Door database annotation processor. 

## Running tests

Note: it is safe to ignore this Javascript error output. This does not
prevent the tests from passing:

```
ERROR in .._imported/kotlinx-io/0.1.10/kotlinx-io.js
Module not found: Error: Can't resolve 'text-encoding' in '/home/mike/src/UstadMobile/build/js/packages_imported/kotlinx-io/0.1.10'
 @ .._imported/kotlinx-io/0.1.10/kotlinx-io.js 8812:21-45 8880:21-45
 @ .._imported/ktor-ktor-client-serialization/1.2.2/ktor-ktor-client-serialization.js
 @ ./kotlin/UstadMobile-lib-database-annotation-processor-mpp-test-test.js
```

## Debugging Javascript tests

It is possible to debug the unit tests that are running in Karma. To do so:

* Run the test 'normally' e.g.

```
$./gradlew lib-database-annotation-processor-mpp-test:jsTest --info
```

In the Gradle output the generated Karma configuration, working directory, 
and the command to run will be output: e.g.

 ```
Starting process 'command '/home/mike/.gradle/nodejs/node-v10.15.3-linux-x64/bin/node''. 
Working directory: /home/mike/src/UstadMobile/build/js/packages/UstadMobile-lib-database-annotation-processor-mpp-test-test 
Command: /home/mike/.gradle/nodejs/node-v10.15.3-linux-x64/bin/node /home/mike/src/UstadMobile/build/js/node_modules/karma/bin/karma start /home/mike/src/UstadMobile/build/js/packages/UstadMobile-lib-database-annotation-processor-mpp-test-test/karma.conf.js --debug
```

To start debugging, go to the same directory as per the output, and append 
__--no-single-run__ to the command line (otherwise Karma will quit as soon 
as the tests are done). When the Chrome browser opens, click the debug
button.
